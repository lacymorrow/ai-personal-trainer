<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Personal Trainer</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .input-style {
            @apply mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500;
        }
        .workout-card {
            transition: transform 0.3s ease;
        }
        .workout-card:hover {
            transform: translateY(-5px);
        }
        .audio-player {
            background: linear-gradient(135deg, #9f7aea 0%, #7f9cf5 100%);
        }
    </style>
</head>
<body class="py-12 px-4">
    <div class="container mx-auto max-w-4xl">
        <div class="text-center mb-12">
            <h1 class="text-5xl font-bold text-white mb-4">AI Personal Trainer</h1>
            <p class="text-xl text-gray-100">Your personalized workout companion powered by artificial intelligence</p>
        </div>
        
        <div class="glass-effect rounded-2xl shadow-xl p-8 mb-8">
            <form id="userForm" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Name</label>
                        <input type="text" name="name" required
                            class="input-style" placeholder="Enter your name">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Phone Number</label>
                        <input type="tel" name="phone" required
                            class="input-style" placeholder="+1 (234) 567-8900">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Fitness Level</label>
                        <select name="fitness_level" required class="input-style">
                            <option value="">Select your level</option>
                            <option value="beginner">Beginner</option>
                            <option value="intermediate">Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Preferred Time</label>
                        <input type="time" name="preferred_time" required class="input-style">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700">Fitness Goals</label>
                    <textarea name="goals" required
                        class="input-style" rows="3"
                        placeholder="What would you like to achieve? (e.g., build muscle, lose weight, improve endurance)"></textarea>
                </div>
                
                <div class="flex justify-center">
                    <button type="submit"
                        class="px-8 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white text-lg font-semibold rounded-lg shadow-lg hover:from-purple-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transform transition-all duration-300 hover:scale-105">
                        Create My Personalized Plan
                    </button>
                </div>
            </form>
        </div>
        
        <div id="workoutPlan" class="glass-effect rounded-2xl shadow-xl p-8 hidden">
            <h2 class="text-3xl font-bold text-gray-800 mb-6">Your Personalized Workout Plan</h2>
            
            <div id="audioPlayer" class="audio-player rounded-xl p-6 text-white mb-8">
                <h3 class="font-bold text-xl mb-4">üéß Your AI Workout Guide</h3>
                <audio id="workoutAudio" controls class="w-full mb-4">
                    <source src="" type="audio/mpeg">
                    Your browser does not support the audio element.
                </audio>
                <button onclick="document.getElementById('workoutAudio').play()"
                    class="w-full bg-white text-purple-600 py-3 px-4 rounded-lg font-semibold hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-purple-600 transition-all duration-300">
                    ‚ñ∂Ô∏è Start Workout Guide
                </button>
            </div>
            
            <div id="planContent" class="space-y-6">
                <!-- Plan content will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        document.getElementById('userForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const submitButton = e.target.querySelector('button[type="submit"]');
            submitButton.disabled = true;
            submitButton.innerHTML = '<span class="animate-pulse">Creating your plan...</span>';
            
            const formData = new FormData(e.target);
            const data = {
                name: formData.get('name'),
                phone: formData.get('phone'),
                fitness_level: formData.get('fitness_level'),
                preferred_time: formData.get('preferred_time'),
                goals: formData.get('goals')
            };
            
            try {
                const response = await fetch('/users/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                // Update audio source
                const audioPlayer = document.getElementById('workoutAudio');
                audioPlayer.src = result.audio_url;
                audioPlayer.load();
                
                // Display workout plan
                const planContent = document.getElementById('planContent');
                planContent.innerHTML = `
                    <div class="space-y-6">
                        <div class="bg-white rounded-xl p-6 shadow-md workout-card">
                            <h3 class="text-2xl font-bold text-gray-800 mb-4">Today's Exercises</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                ${result.workout_plan.exercises.map(ex => `
                                    <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                        <h4 class="font-semibold text-lg text-purple-600 mb-2">${ex.name}</h4>
                                        <div class="text-gray-600">
                                            ${ex.duration ? 
                                                `<p>üïí Duration: ${ex.duration}</p>` : 
                                                `<p>üîÑ Sets: ${ex.sets}</p>
                                                 <p>üéØ Reps: ${ex.reps}</p>`
                                            }
                                            <p>‚è∏Ô∏è Rest: ${ex.rest}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-100 to-indigo-100 rounded-xl p-6 shadow-md workout-card">
                            <h3 class="text-2xl font-bold text-gray-800 mb-2">Your Motivation</h3>
                            <p class="text-gray-700 text-lg italic">"${result.workout_plan.motivation}"</p>
                        </div>
                    </div>
                `;
                
                document.getElementById('workoutPlan').classList.remove('hidden');
                document.getElementById('workoutPlan').scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                console.error('Error:', error);
                alert('There was an error creating your workout plan. Please try again.');
            } finally {
                submitButton.disabled = false;
                submitButton.innerHTML = 'Create My Personalized Plan';
            }
        });
    </script>
</body>
</html>
